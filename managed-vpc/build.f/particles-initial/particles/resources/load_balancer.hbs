{{#resource "m:ec2" "load_balancer"}}
  "Properties": {
    "CrossZone": true,
    "SecurityGroups": {{helper "m:core" "propertyValue" securityGroups}},
    "Subnets": {{helper "m:core" "propertyValue" subnets}},
    "Instances": {{helper "m:core" "propertyValue" instances}},
    "Scheme": {{helper "m:core" "propertyValue" scheme}},
    "ConnectionSettings": {
      "IdleTimeout": 3600
    },
    "Listeners": [
      {
        "LoadBalancerPort": {{helper "m:core" "propertyValue" loadbalancerport}},
        "InstancePort": {{helper "m:core" "propertyValue" instanceport}},
        "InstanceProtocol": {{helper "m:core" "propertyValue" instanceprotocol}},
        "Protocol": {{helper "m:core" "propertyValue" protocol}},
        "SSLCertificateId" : {
          "Fn::If" : [
            "SSLCertificateIdIsNotEmpty",
            {{helper "m:core" "propertyValue" sslcertificateid}},
            {"Ref" : "AWS::NoValue"}
          ]
        }
      }
    ],
    "HealthCheck": {
      "HealthyThreshold": "3",
      "Interval": "10",
      "Timeout": "5",
      "UnhealthyThreshold": "2",
      "Target": {{helper "m:core" "propertyValue" target}}
    },
    "AccessLoggingPolicy": {
      "EmitInterval" : {{helper "m:core" "propertyValue" emitinterval}},
      "Enabled" : {{helper "m:core" "propertyValue" enabled}},
      "S3BucketName" : {{helper "m:core" "propertyValue" s3bucketname}},
      "S3BucketPrefix" : {{helper "m:core" "propertyValue" s3bucketprefix}}
    }

  }
{{/resource}}
